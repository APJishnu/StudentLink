<section class="py-5">
  <div class="container">
    <div class="col-md-6 text-right">
        <a href="/courses" class="btn btn-secondary mt-2">Back</a>
      </div>
    <div class="row justify-content-center">
      <div class="col-md-8">
        <div class="card form-container">
          <div class="card-body">
            <h2 class="text-center mb-4 title">Get Notes printing</h2>

            <form action="/computer" method="post" class="form">
              <div class="form-group input-container m-4">
                <label for="year">Select Academic Year </label>
                <select class="form-control input " name="year" id="yearDropdown">
                  <option value="1">1st Year</option>
                  <option value="2">2nd Year</option>
                  <option value="3">3rd Year</option>
                </select>
              </div>

              <div class="form-group input-container m-4">
                <label for="semester">Select Semester</label>
                <select class="form-control input" name="sem" id="semesterDropdown">
                  <option value="1">Semester 1</option>
                  <option value="2">Semester 2</option>
                </select>
              </div>

              <div class="form-group input-container m-4">
                <label for="subject">Select Subject</label>
                <select class="form-control input" name="name" id="subjectDropdown">
                  <!-- Empty dropdown, to be populated dynamically -->
                  {{#each subjects}}
                    <option value="{{this}}">{{this}}</option>
                  {{/each}}
                </select>
              </div>

              <div class="text-center">
                <button type="submit" class="btn btn-success mt-4 submit">Submit</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  function loadSubjects() {
    const selectedYear = document.getElementById('yearDropdown').value;
    const selectedSemester = document.getElementById('semesterDropdown').value;

    fetch('/admin/printing-subjects', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ year: selectedYear, semester: selectedSemester }),
    })
      .then(response => response.json())
      .then(data => {
        const subjectDropdown = document.getElementById('subjectDropdown');
        subjectDropdown.innerHTML = '';

        data.subjects.forEach(subject => {
          const option = document.createElement('option');
          option.value = subject;
          option.text = subject;
          subjectDropdown.appendChild(option);
        });
      })
      .catch(error => console.error('Error fetching subjects:', error));
  }

  document.getElementById('yearDropdown').addEventListener('change', loadSubjects);
  document.getElementById('semesterDropdown').addEventListener('change', loadSubjects);

  loadSubjects();
</script>
